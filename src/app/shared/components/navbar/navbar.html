<nav class="navbar">
  <div class="navbar-inner">
    <div class="brand">
      <!-- Logo: siempre lleva a /home -->
      <a class="logo" routerLink="/home" aria-label="Ir al inicio">Dulce</a>
    </div>

    <!-- Botón hamburguesa (solo visible en móvil) -->
    <button
      class="menu-toggle"
      type="button"
      [attr.aria-expanded]="isMobileMenuOpen"
      aria-controls="main-menu"
      (click)="toggleMobileMenu()"
    >
      <span class="sr-only">Abrir menú</span>
      <span class="menu-toggle-bar"></span>
      <span class="menu-toggle-bar"></span>
      <span class="menu-toggle-bar"></span>
    </button>

    <!-- Menú principal -->
    <ul id="main-menu" class="menu" [class.open]="isMobileMenuOpen">
      <!-- Promociones -->
      <li
        class="menu-item has-dropdown menu-promociones"
        [class.is-open]="activeMenu === 'promociones'"
        (mouseenter)="openMenu('promociones')"
        (mouseleave)="closeMenu('promociones')"
        (focusin)="openMenu('promociones')"
        (focusout)="handleFocusOut($event, 'promociones')"
      >
        <a
          class="menu-link"
          [routerLink]="['/catalogo']"
          [queryParams]="buildCatalogParams(catalogFilters.promotions)"
          (click)="onCatalogLinkClick($event, catalogFilters.promotions); closeMobileMenu()"
        >
          <span class="menu-label">Promociones</span>
        </a>
        <ul class="dropdown">
          <li>
            <a
              [routerLink]="['/catalogo']"
              [queryParams]="buildCatalogParams(catalogFilters.promotions)"
              (click)="onCatalogLinkClick($event, catalogFilters.promotions); closeMobileMenu()"
            >
              Llévame a las promociones
            </a>
          </li>
        </ul>
      </li>

      <!-- Nuevo -->
      <li
        class="menu-item has-dropdown menu-nuevo"
        [class.is-open]="activeMenu === 'nuevo'"
        (mouseenter)="openMenu('nuevo')"
        (mouseleave)="closeMenu('nuevo')"
        (focusin)="openMenu('nuevo')"
        (focusout)="handleFocusOut($event, 'nuevo')"
      >
        <a
          class="menu-link"
          [routerLink]="['/catalogo']"
          [queryParams]="buildCatalogParams(catalogFilters.newest)"
          (click)="onCatalogLinkClick($event, catalogFilters.newest); closeMobileMenu()"
        >
          <span class="menu-label">Nuevo</span>
        </a>
        <ul class="dropdown">
          <li>
            <a
              [routerLink]="['/catalogo']"
              [queryParams]="buildCatalogParams(catalogFilters.newest)"
              (click)="onCatalogLinkClick($event, catalogFilters.newest); closeMobileMenu()"
            >
              Tendencias
            </a>
          </li>
        </ul>
      </li>

      <!-- Dama -->
      <li
        class="menu-item has-dropdown menu-dama"
        [class.is-open]="activeMenu === 'dama'"
        (mouseenter)="openMenu('dama')"
        (mouseleave)="closeMenu('dama')"
        (focusin)="openMenu('dama')"
        (focusout)="handleFocusOut($event, 'dama')"
      >
        <a
          class="menu-link"
          [routerLink]="['/catalogo']"
          [queryParams]="buildCatalogParams(catalogFilters.dama)"
          (click)="onCatalogLinkClick($event, catalogFilters.dama); closeMobileMenu()"
        >
          <span class="menu-label">Dama</span>
        </a>
        <ul class="dropdown">
          <li>
            <a
              [routerLink]="['/catalogo']"
              [queryParams]="buildCatalogParams(catalogFilters.damaPijamas)"
              (click)="onCatalogLinkClick($event, catalogFilters.damaPijamas); closeMobileMenu()"
            >
              Pijamas
            </a>
          </li>
          <li>
            <a
              [routerLink]="['/catalogo']"
              [queryParams]="buildCatalogParams(catalogFilters.damaBlusas)"
              (click)="onCatalogLinkClick($event, catalogFilters.damaBlusas); closeMobileMenu()"
            >
              Blusas
            </a>
          </li>
          <li>
            <a
              [routerLink]="['/catalogo']"
              [queryParams]="buildCatalogParams(catalogFilters.damaCamisetas)"
              (click)="onCatalogLinkClick($event, catalogFilters.damaCamisetas); closeMobileMenu()"
            >
              Camisetas
            </a>
          </li>
          <li>
            <a
              [routerLink]="['/catalogo']"
              [queryParams]="buildCatalogParams(catalogFilters.damaLeggins)"
              (click)="onCatalogLinkClick($event, catalogFilters.damaLeggins); closeMobileMenu()"
            >
              Leggins
            </a>
          </li>
        </ul>
      </li>

      <!-- Niña -->
      <li
        class="menu-item has-dropdown menu-nina"
        [class.is-open]="activeMenu === 'nina'"
        (mouseenter)="openMenu('nina')"
        (mouseleave)="closeMenu('nina')"
        (focusin)="openMenu('nina')"
        (focusout)="handleFocusOut($event, 'nina')"
      >
        <a
          class="menu-link"
          [routerLink]="['/catalogo']"
          [queryParams]="buildCatalogParams(catalogFilters.nina)"
          (click)="onCatalogLinkClick($event, catalogFilters.nina); closeMobileMenu()"
        >
          <span class="menu-label">Niña</span>
        </a>
        <ul class="dropdown">
          <li>
            <a
              [routerLink]="['/catalogo']"
              [queryParams]="buildCatalogParams(catalogFilters.ninaPijamas)"
              (click)="onCatalogLinkClick($event, catalogFilters.ninaPijamas); closeMobileMenu()"
            >
              Pijamas
            </a>
          </li>
          <li>
            <a
              [routerLink]="['/catalogo']"
              [queryParams]="buildCatalogParams(catalogFilters.ninaBlusas)"
              (click)="onCatalogLinkClick($event, catalogFilters.ninaBlusas); closeMobileMenu()"
            >
              Blusas
            </a>
          </li>
          <li>
            <a
              [routerLink]="['/catalogo']"
              [queryParams]="buildCatalogParams(catalogFilters.ninaCamisetas)"
              (click)="onCatalogLinkClick($event, catalogFilters.ninaCamisetas); closeMobileMenu()"
            >
              Camisetas
            </a>
          </li>
          <li>
            <a
              [routerLink]="['/catalogo']"
              [queryParams]="buildCatalogParams(catalogFilters.ninaLeggins)"
              (click)="onCatalogLinkClick($event, catalogFilters.ninaLeggins); closeMobileMenu()"
            >
              Leggins
            </a>
          </li>
        </ul>
      </li>

      <!-- Acceso -->
      <li
        class="menu-item has-dropdown menu-acceso"
        [class.is-open]="activeMenu === 'acceso'"
        (mouseenter)="openMenu('acceso')"
        (mouseleave)="closeMenu('acceso')"
        (focusin)="openMenu('acceso')"
        (focusout)="handleFocusOut($event, 'acceso')"
      >
        <button class="menu-link" type="button" disabled aria-disabled="true">
          <span class="menu-label">Acceso</span>
        </button>
        <ul class="dropdown">
          <li>
            <span class="menu-info">Acceso para empleados disponible próximamente.</span>
          </li>
        </ul>
      </li>
    </ul>

    <div class="navbar-actions">
      <a class="cart-entry" routerLink="/carrito" aria-label="Abrir carrito">
        <span class="cart-entry-icon" aria-hidden="true">🛒</span>
        <span class="cart-entry-label">Carrito</span>
        <span class="cart-entry-count">{{ (totalCartItems$ | async) || 0 }}</span>
      </a>
    </div>
  </div>
</nav>
