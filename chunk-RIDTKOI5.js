import{a as Ce}from"./chunk-FYI3VIXZ.js";import{b as ie,d as re,e as ne,f as oe,g as x,h as ae,i as se,k as le,l as ce,n as pe,o as de,p as me,q as ge,r as ue,u as fe,v as he}from"./chunk-DRQFHDLW.js";import{a as L}from"./chunk-46XEFVVV.js";import{a as _e}from"./chunk-EVMJOCTO.js";import{c as W,e as ee,f as te}from"./chunk-YGPR4EP3.js";import{$a as F,Ba as q,Cb as U,Db as X,Eb as H,Fa as _,Fb as K,Gb as Y,Lb as J,Oa as k,Ra as g,Sa as o,Ta as n,Ua as I,Va as A,W as u,Wa as B,X as f,Xa as y,Ya as h,Za as d,_a as M,a as D,ab as E,b as Q,bb as N,cb as T,db as c,eb as b,fb as O,gb as Z,jb as P,kb as V,mb as z,nb as $,pa as j,sa as s,ub as G,wa as w}from"./chunk-3VNZBXZS.js";var ye=["filtersButtonRef"],be=["cartToggleButton"],xe=["productsGrid"];function Se(a,t){if(a&1){let e=y();o(0,"div",35),h("click",function(){u(e);let r=d();return f(r.closeFilters())}),n()}}function Pe(a,t){if(a&1){let e=y();o(0,"div",36)(1,"label")(2,"input",37),h("change",function(r){let l=u(e).$implicit,m=d();return f(m.onCheckboxChange("categories",l,r.target.checked))}),n(),o(3,"span"),c(4),n()()()}if(a&2){let e=t.$implicit,i=d();s(2),g("checked",i.filtersForm.controls.categories.value.includes(e)),s(2),b(e)}}function we(a,t){if(a&1){let e=y();o(0,"div",36)(1,"label")(2,"input",37),h("change",function(r){let l=u(e).$implicit,m=d();return f(m.onCheckboxChange("subCategories",l,r.target.checked))}),n(),o(3,"span"),c(4),n()()()}if(a&2){let e=t.$implicit,i=d();s(2),g("checked",i.filtersForm.controls.subCategories.value.includes(e)),s(2),b(e)}}function Oe(a,t){if(a&1){let e=y();o(0,"div",36)(1,"label")(2,"input",37),h("change",function(r){let l=u(e).$implicit,m=d();return f(m.onCheckboxChange("sizes",l,r.target.checked))}),n(),o(3,"span"),c(4),n()()()}if(a&2){let e=t.$implicit,i=d();s(2),g("checked",i.filtersForm.controls.sizes.value.includes(e)),s(2),b(e)}}function ke(a,t){if(a&1){let e=y();o(0,"div",36)(1,"label")(2,"input",37),h("change",function(r){let l=u(e).$implicit,m=d();return f(m.onCheckboxChange("colors",l,r.target.checked))}),n(),o(3,"span"),c(4),n()()()}if(a&2){let e=t.$implicit,i=d();s(2),g("checked",i.filtersForm.controls.colors.value.includes(e)),s(2),b(e)}}function Me(a,t){if(a&1){let e=y();o(0,"button",41),h("click",function(){let r=u(e).$implicit,l=d(2);return f(l.removeFilterChip(r))}),c(1),n()}if(a&2){let e=t.$implicit;s(),O(" ",e.label," \u2715 ")}}function Fe(a,t){if(a&1){let e=y();o(0,"section",38),_(1,Me,2,1,"button",39),o(2,"button",40),h("click",function(){u(e);let r=d();return f(r.clearFilters())}),c(3,"Limpiar filtros"),n()()}if(a&2){let e=d();s(),g("ngForOf",e.appliedChips)("ngForTrackBy",e.trackByChip)}}function Ee(a,t){if(a&1){let e=y();o(0,"article",44)(1,"div",45),I(2,"img",46),n(),o(3,"div",47)(4,"h3",48),c(5),n(),o(6,"p",49),c(7),P(8,"currency"),n(),o(9,"p",50)(10,"span",51),c(11),n(),o(12,"span",51),c(13),n(),o(14,"span",51),c(15),n(),o(16,"span",52),c(17),n()(),o(18,"div",53)(19,"button",54),h("click",function(){let r=u(e).$implicit,l=d(2);return f(l.addToCart(r))}),c(20," Agregar al carrito "),n()()()()}if(a&2){let e=t.$implicit;s(2),g("ngSrc",e.image)("alt",e.name),s(3),b(e.name),s(2),b(z(8,8,e.price,"USD","symbol","1.0-0")),s(4),b(e.category),s(2),b(e.subCategory),s(2),O("Talla: ",e.size),s(2),O("Color: ",e.color)}}function Te(a,t){if(a&1&&(o(0,"section",42),_(1,Ee,21,13,"article",43),n()),a&2){let e=d();s(),g("ngForOf",e.pagedProducts)("ngForTrackBy",e.trackById)}}function Ve(a,t){if(a&1&&(o(0,"div",55)(1,"p"),c(2),n()()),a&2){let e=d();s(2),b(e.emptyStateMessage)}}function ze(a,t){if(a&1){let e=y();o(0,"nav",56)(1,"button",57),h("click",function(){u(e);let r=d();return f(r.goToPreviousPage())}),c(2,"Anterior"),n(),o(3,"span"),c(4),n(),o(5,"button",57),h("click",function(){u(e);let r=d();return f(r.goToNextPage())}),c(6,"Siguiente"),n()()}if(a&2){let e=d();s(),g("disabled",e.page===1),s(3),Z("P\xE1gina ",e.page," de ",e.totalPages),s(),g("disabled",e.page===e.totalPages)}}function Le(a,t){if(a&1&&(o(0,"span",58),c(1),n()),a&2){let e=t.ngIf;s(),b(e)}}function Ie(a,t){if(a&1&&(o(0,"p",74),c(1),n()),a&2){let e=d().$implicit;s(),O("Talla: ",e.product.size)}}function Ae(a,t){if(a&1&&(o(0,"p",74),c(1),n()),a&2){let e=d().$implicit;s(),O("Color: ",e.product.color)}}function Be(a,t){if(a&1){let e=y();o(0,"article",63)(1,"div",64),I(2,"img",65),n(),o(3,"div",66)(4,"h3"),c(5),n(),_(6,Ie,2,1,"p",67)(7,Ae,2,1,"p",67),o(8,"p",68),c(9),P(10,"currency"),n(),o(11,"div",69)(12,"button",70),h("click",function(){let r=u(e).$implicit,l=d(3);return f(l.decrementCartItem(r.product.id))}),c(13," \u2212 "),n(),o(14,"input",71),h("change",function(r){let l=u(e).$implicit,m=d(3);return f(m.updateCartQuantity(l.product.id,r.target.value))}),n(),o(15,"button",72),h("click",function(){let r=u(e).$implicit,l=d(3);return f(l.incrementCartItem(r.product.id))}),c(16," + "),n()()(),o(17,"button",73),h("click",function(){let r=u(e).$implicit,l=d(3);return f(l.removeCartItem(r.product.id))}),c(18," \xD7 "),n()()}if(a&2){let e=t.$implicit;s(2),g("src",e.product.image,j)("alt",e.product.name),s(3),b(e.product.name),s(),g("ngIf",e.product.size),s(),g("ngIf",e.product.color),s(2),b(z(10,7,e.product.price,"USD","symbol","1.0-0")),s(5),g("value",e.quantity)}}function Ne(a,t){if(a&1&&(A(0),_(1,Be,19,12,"article",62),B()),a&2){let e=d().ngIf,i=d();s(),g("ngForOf",e)("ngForTrackBy",i.trackByCartItem)}}function $e(a,t){if(a&1){let e=y();o(0,"div",75)(1,"div",76)(2,"span"),c(3,"Subtotal"),n(),o(4,"strong"),c(5),P(6,"async"),P(7,"currency"),n()(),o(8,"p",77),c(9,"El env\xEDo y los impuestos se calculan al finalizar la compra."),n(),o(10,"a",78),h("click",function(){u(e);let r=d(2);return f(r.closeCartPanel())}),c(11,"Ver carrito completo"),n(),o(12,"a",79),h("click",function(){u(e);let r=d(2);return f(r.closeCartPanel())}),c(13,"Finalizar compra"),n()()}if(a&2){let e=d(2);s(5),b(z(7,3,V(6,1,e.cartTotal$),"USD","symbol","1.0-0"))}}function Re(a,t){if(a&1&&(A(0),o(1,"div",59),_(2,Ne,2,2,"ng-container",60),n(),_(3,$e,14,8,"div",61),B()),a&2){let e=t.ngIf;d();let i=N(71);s(2),g("ngIf",e.length)("ngIfElse",i),s(),g("ngIf",e.length)}}function De(a,t){if(a&1){let e=y();o(0,"div",80)(1,"p"),c(2,"Tu carrito est\xE1 vac\xEDo. Agrega tus prendas favoritas para verlas aqu\xED."),n(),o(3,"a",81),h("click",function(){u(e);let r=d();return f(r.closeCartPanel())}),c(4,"Explorar cat\xE1logo"),n()()}}function Qe(a,t){if(a&1){let e=y();o(0,"div",82),h("click",function(){u(e);let r=d();return f(r.closeCartPanel())}),n()}}var R=class a{constructor(t,e,i,r,l){this.router=t;this.route=e;this.cdr=i;this.catalogNavigation=r;this.cartService=l;this.cartItems$=this.cartService.items$,this.cartCount$=this.cartService.totalQuantity$,this.cartTotal$=this.cartService.subtotal$}static STORAGE_KEY="catalogo_filters_state";filtersButton;cartToggleButton;productsGridRef;isBootstrapping=!0;itemsPerPage=12;lastQuerySignature=null;categoryOptions=["Dama","Ni\xF1a"];subCategoryOptions=["Pijamas","Blusas","Camisetas","Leggins"];sizeOptions=["XS","S","M","L","XL","4","6","8","10","12","14"];colorOptions=["Negro","Blanco","Azul","Rojo","Verde","Amarillo","Morado","Rosa"];sortOptions=[{value:"relevance",label:"Relevancia"},{value:"priceAsc",label:"Precio \u2191"},{value:"priceDesc",label:"Precio \u2193"},{value:"newest",label:"Novedades"}];filtersForm=new oe({categories:new x([],{nonNullable:!0}),subCategories:new x([],{nonNullable:!0}),sizes:new x([],{nonNullable:!0}),colors:new x([],{nonNullable:!0}),priceMin:new x(null),priceMax:new x(null),sort:new x("relevance",{nonNullable:!0})});cartItems$;cartCount$;cartTotal$;allProducts=[{id:"p-001",name:"Pijama sat\xEDn suave dama",price:1249,image:"https://picsum.photos/seed/dama-pijama-001/300/400",category:"Dama",subCategory:"Pijamas",size:"M",color:"Rosa",createdAt:"2024-04-12T07:50:00Z"},{id:"p-002",name:"Pijama algod\xF3n fresco dama",price:999,image:"https://picsum.photos/seed/dama-pijama-002/300/400",category:"Dama",subCategory:"Pijamas",size:"S",color:"Azul",createdAt:"2024-03-28T16:20:00Z"},{id:"p-003",name:"Blusa bordada ivory",price:759,image:"https://picsum.photos/seed/dama-blusa-001/300/400",category:"Dama",subCategory:"Blusas",size:"M",color:"Blanco",createdAt:"2024-03-08T20:10:00Z"},{id:"p-004",name:"Blusa plisada nocturna",price:829,image:"https://picsum.photos/seed/dama-blusa-002/300/400",category:"Dama",subCategory:"Blusas",size:"L",color:"Negro",createdAt:"2024-02-28T15:30:00Z"},{id:"p-005",name:"Camiseta b\xE1sica \xEDndigo",price:449,image:"https://picsum.photos/seed/dama-camiseta-001/300/400",category:"Dama",subCategory:"Camisetas",size:"S",color:"Azul",createdAt:"2024-02-12T08:10:00Z"},{id:"p-006",name:"Camiseta esencial carm\xEDn",price:479,image:"https://picsum.photos/seed/dama-camiseta-002/300/400",category:"Dama",subCategory:"Camisetas",size:"M",color:"Rojo",createdAt:"2024-01-22T09:15:00Z"},{id:"p-007",name:"Leggins esculpidos grafito",price:699,image:"https://picsum.photos/seed/dama-leggins-001/300/400",category:"Dama",subCategory:"Leggins",size:"L",color:"Negro",createdAt:"2024-01-12T17:25:00Z"},{id:"p-008",name:"Leggins compresi\xF3n oliva",price:729,image:"https://picsum.photos/seed/dama-leggins-002/300/400",category:"Dama",subCategory:"Leggins",size:"XL",color:"Verde",createdAt:"2023-12-27T19:00:00Z"},{id:"p-009",name:"Pijama algod\xF3n estelar ni\xF1a",price:589,image:"https://picsum.photos/seed/nina-pijama-001/300/400",category:"Ni\xF1a",subCategory:"Pijamas",size:"6",color:"Rosa",createdAt:"2024-04-04T18:45:00Z"},{id:"p-010",name:"Pijama polar constelaci\xF3n ni\xF1a",price:619,image:"https://picsum.photos/seed/nina-pijama-002/300/400",category:"Ni\xF1a",subCategory:"Pijamas",size:"8",color:"Azul",createdAt:"2024-03-15T10:00:00Z"},{id:"p-011",name:"Blusa floral amanecer",price:389,image:"https://picsum.photos/seed/nina-blusa-001/300/400",category:"Ni\xF1a",subCategory:"Blusas",size:"10",color:"Amarillo",createdAt:"2024-02-02T13:00:00Z"},{id:"p-012",name:"Blusa magia lavanda",price:409,image:"https://picsum.photos/seed/nina-blusa-002/300/400",category:"Ni\xF1a",subCategory:"Blusas",size:"12",color:"Morado",createdAt:"2023-12-10T12:00:00Z"},{id:"p-013",name:"Camiseta algod\xF3n nube",price:329,image:"https://picsum.photos/seed/nina-camiseta-001/300/400",category:"Ni\xF1a",subCategory:"Camisetas",size:"4",color:"Blanco",createdAt:"2023-11-18T14:05:00Z"},{id:"p-014",name:"Camiseta ola turquesa",price:339,image:"https://picsum.photos/seed/nina-camiseta-002/300/400",category:"Ni\xF1a",subCategory:"Camisetas",size:"6",color:"Azul",createdAt:"2023-10-21T09:40:00Z"},{id:"p-015",name:"Leggins aventura grafito",price:369,image:"https://picsum.photos/seed/nina-leggins-001/300/400",category:"Ni\xF1a",subCategory:"Leggins",size:"8",color:"Negro",createdAt:"2023-09-14T11:00:00Z"},{id:"p-016",name:"Leggins energ\xEDa jade",price:379,image:"https://picsum.photos/seed/nina-leggins-002/300/400",category:"Ni\xF1a",subCategory:"Leggins",size:"10",color:"Verde",createdAt:"2023-08-30T08:30:00Z"}];page=1;filteredProducts=[...this.allProducts];totalPages=Math.max(1,Math.ceil(this.filteredProducts.length/this.itemsPerPage));pagedProducts=this.filteredProducts.slice(0,this.itemsPerPage);appliedChips=[];isFiltersOpen=!1;isCartPanelOpen=!1;emptyStateMessage="No se encontraron productos con los filtros seleccionados.";resizeObserver;selectedCategories=new Set;selectedSubCategories=new Set;selectedSizes=new Set;selectedColors=new Set;handleViewportResize=()=>this.onViewportChange();ngOnInit(){let t=this.route.snapshot.queryParamMap;if(this.hasQueryParams(t))this.handleQueryParamsChange(t,{force:!0});else{let e=this.loadStateFromStorage();e&&this.applyStoredState(e),this.filterProducts(),this.lastQuerySignature=this.paramsSignature(t)}this.isBootstrapping=!1,this.cdr.detectChanges(),this.filtersForm.valueChanges.pipe(L()).subscribe(()=>{this.isBootstrapping||(this.page=1,this.syncQueryFromForm(),this.filterProducts())}),this.observeCatalogNavigation(),this.catalogNavigation.navigation$.pipe(L()).subscribe(e=>this.applyNavbarOverrides(e))}ngAfterViewInit(){this.onViewportChange(),queueMicrotask(()=>{this.filterProducts(),this.cdr.detectChanges()}),this.isBrowser()&&(window.addEventListener("resize",this.handleViewportResize,{passive:!0}),typeof ResizeObserver<"u"&&this.productsGridRef)}ngOnDestroy(){this.enableBodyScroll(),this.isBrowser()&&window.removeEventListener("resize",this.handleViewportResize),this.resizeObserver?.disconnect(),this.resizeObserver=void 0}observeCatalogNavigation(){this.route.queryParamMap.pipe(L()).subscribe(t=>{this.handleQueryParamsChange(t)})}handleQueryParamsChange(t,e={}){let i=this.paramsSignature(t);!e.force&&this.lastQuerySignature===i||(this.lastQuerySignature=i,this.isBootstrapping=!0,this.syncFormFromQuery(t),this.isBootstrapping=!1,this.page=Math.max(1,this.page),this.filterProducts(),this.cdr.detectChanges())}applyFilters(){this.page=1,this.syncQueryFromForm(),this.filterProducts()}clearFilters(){this.filtersForm.setValue({categories:[],subCategories:[],sizes:[],colors:[],priceMin:null,priceMax:null,sort:"relevance"}),this.applyFilters()}onCheckboxChange(t,e,i){let r=this.filtersForm.get(t),l=new Set(r.value??[]);i?l.add(e):l.delete(e),r.setValue([...l],{emitEvent:!1}),this.page=1,this.syncQueryFromForm(),this.filterProducts()}onSortChange(){this.page=1,this.syncQueryFromForm(),this.filterProducts()}onPriceChange(){let{priceMin:t,priceMax:e}=this.filtersForm.getRawValue();t!==null&&e!==null&&t>e&&this.filtersForm.patchValue({priceMin:e,priceMax:t},{emitEvent:!1}),this.page=1,this.syncQueryFromForm(),this.filterProducts()}removeFilterChip(t){switch(t.type){case"categories":case"subCategories":case"sizes":case"colors":{let e=this.filtersForm.get(t.type),i=(e.value??[]).filter(r=>r!==t.value);e.setValue(i);break}case"price":this.filtersForm.patchValue({priceMin:null,priceMax:null});break}this.applyFilters()}goToPreviousPage(){this.page>1&&(this.page-=1,this.syncQueryFromForm(),this.updatePagination())}goToNextPage(){this.page<this.totalPages&&(this.page+=1,this.syncQueryFromForm(),this.updatePagination())}goToPage(t){t>=1&&t<=this.totalPages&&t!==this.page&&(this.page=t,this.syncQueryFromForm(),this.updatePagination())}openFilters(){this.isFiltersOpen=!0,this.disableBodyScroll()}closeFilters(){this.isFiltersOpen=!1,this.enableBodyScroll(),queueMicrotask(()=>this.filtersButton?.nativeElement.focus())}toggleCartPanel(){this.isCartPanelOpen=!this.isCartPanelOpen,this.isCartPanelOpen||queueMicrotask(()=>this.cartToggleButton?.nativeElement.focus()),this.cdr.markForCheck()}openCartPanel(){this.isCartPanelOpen||(this.isCartPanelOpen=!0,this.cdr.markForCheck())}closeCartPanel(){this.isCartPanelOpen&&(this.isCartPanelOpen=!1,queueMicrotask(()=>this.cartToggleButton?.nativeElement.focus()),this.cdr.markForCheck())}addToCart(t){this.cartService.addItem(t),this.openCartPanel()}incrementCartItem(t){this.cartService.increment(t)}decrementCartItem(t){this.cartService.decrement(t)}updateCartQuantity(t,e){let i=Number(e);Number.isFinite(i)&&this.cartService.updateQuantity(t,i)}removeCartItem(t){this.cartService.removeItem(t)}trackById(t,e){return e.id}trackByCartItem(t,e){return e.product.id}trackByChip(t,e){return`${e.type}-${e.value}`}trackByCategory(t,e){return e}trackBySize(t,e){return e}trackByColor(t,e){return e}isCategorySelected(t){return this.selectedCategories.has(t)}isSizeSelected(t){return this.selectedSizes.has(t)}isColorSelected(t){return this.selectedColors.has(t)}filterProducts(){let{categories:t,subCategories:e,sizes:i,colors:r,priceMin:l,priceMax:m,sort:v}=this.filtersForm.getRawValue(),p=[...this.allProducts];t.length&&(p=p.filter(C=>t.includes(C.category))),e.length&&(p=p.filter(C=>e.includes(C.subCategory))),i.length&&(p=p.filter(C=>i.includes(C.size))),r.length&&(p=p.filter(C=>r.includes(C.color))),l!==null&&(p=p.filter(C=>C.price>=l)),m!==null&&(p=p.filter(C=>C.price<=m)),p=this.sortProducts(p,v),this.filteredProducts=p,this.updateSelectionSets(t,e,i,r),this.updateAppliedChips(),this.updatePagination(),this.updateEmptyStateMessage(p.length,t,e),this.saveStateToStorage({categories:t,subCategories:e,sizes:i,colors:r,priceMin:l,priceMax:m,sort:v,page:this.page}),this.cdr.markForCheck()}sortProducts(t,e){switch(e){case"priceAsc":return[...t].sort((i,r)=>i.price-r.price);case"priceDesc":return[...t].sort((i,r)=>r.price-i.price);case"newest":return[...t].sort((i,r)=>new Date(r.createdAt).getTime()-new Date(i.createdAt).getTime());default:return[...t]}}updatePagination(){let t=this.filteredProducts.length;this.totalPages=t>0?Math.ceil(t/this.itemsPerPage):1,this.page>this.totalPages&&(this.page=this.totalPages),this.page<1&&(this.page=1);let e=(this.page-1)*this.itemsPerPage;this.pagedProducts=this.filteredProducts.slice(e,e+this.itemsPerPage),this.cdr.markForCheck()}updateAppliedChips(){let t=[],{categories:e,subCategories:i,sizes:r,colors:l,priceMin:m,priceMax:v}=this.filtersForm.getRawValue();if(e.forEach(p=>{t.push({type:"categories",value:p,label:p})}),i.forEach(p=>{t.push({type:"subCategories",value:p,label:`Tipo: ${p}`})}),r.forEach(p=>{t.push({type:"sizes",value:p,label:`Talla ${p}`})}),l.forEach(p=>{t.push({type:"colors",value:p,label:p})}),m!==null||v!==null){let p=m!==null?`$${m}`:"Min",C=v!==null?`$${v}`:"Max";t.push({type:"price",value:`${m??""}-${v??""}`,label:`Precio: ${p} - ${C}`})}this.appliedChips=t}updateEmptyStateMessage(t,e,i){if(t>0){this.emptyStateMessage="No se encontraron productos con los filtros seleccionados.";return}if(i.length===1){let r=i[0].toLocaleLowerCase();if(e.length===1){let l=e[0].toLocaleLowerCase();this.emptyStateMessage=`Por ahora no tenemos ${r} para ${l}.`}else this.emptyStateMessage=`Por ahora no tenemos ${r} disponibles.`;return}if(e.length===1){let r=e[0].toLocaleLowerCase();this.emptyStateMessage=`No encontramos productos para ${r} con estos filtros.`;return}this.emptyStateMessage="No se encontraron productos con los filtros seleccionados."}updateSelectionSets(t,e,i,r){this.selectedCategories=new Set(t),this.selectedSubCategories=new Set(e),this.selectedSizes=new Set(i),this.selectedColors=new Set(r)}onViewportChange(){this.updatePagination()}applyNavbarOverrides(t){this.isBootstrapping=!0;let e=this.normalizeOverrides(t.categories,this.categoryOptions),i=this.normalizeOverrides(t.subCategories,this.subCategoryOptions),r=this.normalizeOverrides(t.sizes,this.sizeOptions),l=this.normalizeOverrides(t.colors,this.colorOptions),m=this.parseNumber(t.priceMin),v=this.parseNumber(t.priceMax),p=typeof t.sort=="string"?t.sort:null,C=this.sortOptions.some(S=>S.value===p)?p:"relevance";this.filtersForm.setValue({categories:e,subCategories:i,sizes:r,colors:l,priceMin:m,priceMax:v,sort:C},{emitEvent:!1}),this.page=1,this.isBootstrapping=!1,this.filterProducts()}syncFormFromQuery(t){let e=this.getQueryArray(t,"categories",this.categoryOptions),i=this.getQueryArray(t,"subCategories",this.subCategoryOptions),r=this.getQueryArray(t,"sizes",this.sizeOptions),l=this.getQueryArray(t,"colors",this.colorOptions),m=this.parseNumber(t.get("priceMin")),v=this.parseNumber(t.get("priceMax")),p=t.get("sort"),C=this.sortOptions.some(ve=>ve.value===p)?p:"relevance",S=this.parseNumber(t.get("page"));this.page=S!==null&&S>0?Math.floor(S):1,this.filtersForm.setValue({categories:e,subCategories:i,sizes:r,colors:l,priceMin:m,priceMax:v,sort:C},{emitEvent:!1})}syncQueryFromForm(){if(this.isBootstrapping)return;let{categories:t,subCategories:e,sizes:i,colors:r,priceMin:l,priceMax:m,sort:v}=this.filtersForm.getRawValue(),p={categories:t.length?t.join(","):null,subCategories:e.length?e.join(","):null,sizes:i.length?i.join(","):null,colors:r.length?r.join(","):null,priceMin:l??null,priceMax:m??null,sort:v!=="relevance"?v:null,page:this.page>1?this.page:null},C=this.paramsSignature(this.route.snapshot.queryParamMap),S=this.paramsObjectSignature(p);C!==S&&this.router.navigate([],{relativeTo:this.route,queryParams:p,replaceUrl:!0})}hasQueryParams(t){return t.keys.some(e=>t.get(e)!==null&&t.get(e)!=="")}applyStoredState(t){this.filtersForm.setValue({categories:this.filterAllowedValues(t.categories,this.categoryOptions),subCategories:this.filterAllowedValues(t.subCategories,this.subCategoryOptions),sizes:this.filterAllowedValues(t.sizes,this.sizeOptions),colors:this.filterAllowedValues(t.colors,this.colorOptions),priceMin:t.priceMin,priceMax:t.priceMax,sort:this.sortOptions.some(e=>e.value===t.sort)?t.sort:"relevance"}),this.page=t.page>0?Math.floor(t.page):1}loadStateFromStorage(){if(!this.isBrowser())return null;try{let t=window.localStorage.getItem(a.STORAGE_KEY);if(!t)return null;let e=JSON.parse(t);return{categories:this.filterAllowedValues(e.categories??[],this.categoryOptions),subCategories:this.filterAllowedValues(e.subCategories??[],this.subCategoryOptions),sizes:this.filterAllowedValues(e.sizes??[],this.sizeOptions),colors:this.filterAllowedValues(e.colors??[],this.colorOptions),priceMin:this.parseNumber(e.priceMin),priceMax:this.parseNumber(e.priceMax),sort:this.sortOptions.some(i=>i.value===e.sort)?e.sort:"relevance",page:typeof e.page=="number"&&Number.isFinite(e.page)&&e.page>0?Math.floor(e.page):1}}catch(t){return console.error("Error al cargar filtros del cat\xE1logo",t),null}}saveStateToStorage(t){if(this.isBrowser())try{window.localStorage.setItem(a.STORAGE_KEY,JSON.stringify(Q(D({},t),{page:this.page})))}catch(e){console.error("Error al guardar filtros del cat\xE1logo",e)}}getQueryArray(t,e,i){let r=t.getAll(e);return(r.length?r:t.get(e)?.split(",")??[]).map(m=>m.trim()).filter(m=>i.includes(m))}filterAllowedValues(t,e){return Array.isArray(t)?t.map(i=>`${i}`.trim()).filter(i=>e.includes(i)):[]}parseNumber(t){if(t==null||t==="")return null;let e=Number(t);return Number.isFinite(e)?e:null}disableBodyScroll(){this.isBrowser()&&(document.body.style.overflow="hidden")}enableBodyScroll(){this.isBrowser()&&document.body.style.removeProperty("overflow")}isBrowser(){return typeof window<"u"&&typeof window.document<"u"}paramsObjectSignature(t){return Object.keys(t||{}).filter(r=>t[r]!=null&&t[r]!=="").sort().map(r=>{let l=t[r],m=Array.isArray(l)?l:`${l}`.split(",");return`${r}=${m.map(v=>`${v}`.trim()).filter(Boolean).sort().join(",")}`}).join("&")}paramsSignature(t){return[...t.keys].sort().map(i=>{let r=t.getAll(i),l=r.length?r:t.get(i)?.split(",")??[];return`${i}=${l.map(m=>m.trim()).filter(Boolean).sort().join(",")}`}).join("&")}normalizeOverrides(t,e){return t==null?[]:Array.isArray(t)?t.map(r=>`${r}`.trim()).filter(r=>e.includes(r)):`${t}`.split(",").map(r=>r.trim()).filter(r=>e.includes(r))}static \u0275fac=function(e){return new(e||a)(w(ee),w(W),w(G),w(Ce),w(_e))};static \u0275cmp=q({type:a,selectors:[["app-catalogo-list"]],viewQuery:function(e,i){if(e&1&&(M(ye,5),M(be,5),M(xe,5)),e&2){let r;F(r=E())&&(i.filtersButton=r.first),F(r=E())&&(i.cartToggleButton=r.first),F(r=E())&&(i.productsGridRef=r.first)}},decls:73,vars:27,consts:[["filtersButtonRef",""],["emptyState",""],["cartToggleButton",""],["emptyCartPanel",""],[1,"catalog-wrapper"],[1,"mobile-filters-bar"],["type","button","aria-controls","catalog-filters",1,"filters-toggle",3,"click"],["class","filters-backdrop",3,"click",4,"ngIf"],["id","catalog-filters","aria-label","Filtros",1,"filters-panel"],[1,"filters-form",3,"formGroup"],[1,"filters-section"],["class","option",4,"ngFor","ngForOf"],[1,"price-inputs"],["type","number","formControlName","priceMin","min","0",3,"change"],["type","number","formControlName","priceMax","min","0",3,"change"],[1,"catalog-content"],["class","applied-filters",4,"ngIf"],[1,"toolbar"],[3,"change","formControl"],["value","relevance"],["value","priceAsc"],["value","priceDesc"],["value","newest"],["class","products",4,"ngIf","ngIfElse"],["class","pagination","aria-label","Paginaci\xF3n de productos",4,"ngIf"],["type","button","aria-controls","catalog-cart-panel",1,"cart-toggle",3,"click"],["aria-hidden","true",1,"cart-toggle-icon"],[1,"cart-toggle-label"],["class","cart-toggle-count",4,"ngIf"],["id","catalog-cart-panel","role","dialog","aria-modal","false","aria-labelledby","catalog-cart-title",1,"cart-panel"],[1,"cart-panel-header"],["id","catalog-cart-title"],["type","button","aria-label","Cerrar carrito",1,"cart-panel-close",3,"click"],[4,"ngIf"],["class","cart-panel-backdrop","aria-hidden","true",3,"click",4,"ngIf"],[1,"filters-backdrop",3,"click"],[1,"option"],["type","checkbox",3,"change","checked"],[1,"applied-filters"],["class","chip","type","button",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],["type","button",1,"clear-all",3,"click"],["type","button",1,"chip",3,"click"],[1,"products"],["class","product-card",4,"ngFor","ngForOf","ngForTrackBy"],[1,"product-card"],[1,"product-media"],["width","300","height","400","loading","lazy",3,"ngSrc","alt"],[1,"product-info"],[1,"product-name"],[1,"price"],[1,"product-tags"],[1,"tag"],[1,"tag","tag-color"],[1,"product-actions"],["type","button",1,"add-to-cart",3,"click"],[1,"empty-state"],["aria-label","Paginaci\xF3n de productos",1,"pagination"],["type","button",3,"click","disabled"],[1,"cart-toggle-count"],[1,"cart-panel-body"],[4,"ngIf","ngIfElse"],["class","cart-panel-footer",4,"ngIf"],["class","cart-panel-item",4,"ngFor","ngForOf","ngForTrackBy"],[1,"cart-panel-item"],[1,"item-thumb"],["loading","lazy",3,"src","alt"],[1,"item-info"],["class","item-meta",4,"ngIf"],[1,"item-price"],[1,"item-quantity-control"],["type","button","aria-label","Disminuir cantidad",3,"click"],["type","number","min","1",3,"change","value"],["type","button","aria-label","Aumentar cantidad",3,"click"],["type","button","aria-label","Eliminar producto",1,"remove-item",3,"click"],[1,"item-meta"],[1,"cart-panel-footer"],[1,"cart-panel-subtotal"],[1,"cart-panel-note"],["routerLink","/carrito",1,"cart-panel-link",3,"click"],["routerLink","/checkout",1,"cart-panel-checkout",3,"click"],[1,"cart-panel-empty"],["routerLink","/catalogo",3,"click"],["aria-hidden","true",1,"cart-panel-backdrop",3,"click"]],template:function(e,i){if(e&1){let r=y();o(0,"div",4)(1,"div",5)(2,"button",6,0),h("click",function(){return u(r),f(i.openFilters())}),c(4," Filtros "),n()(),_(5,Se,1,0,"div",7),o(6,"aside",8)(7,"form",9)(8,"div",10)(9,"h3"),c(10,"Categor\xEDa"),n(),_(11,Pe,5,2,"div",11),n(),o(12,"div",10)(13,"h3"),c(14,"Tipo de prenda"),n(),_(15,we,5,2,"div",11),n(),o(16,"div",10)(17,"h3"),c(18,"Talla"),n(),_(19,Oe,5,2,"div",11),n(),o(20,"div",10)(21,"h3"),c(22,"Color"),n(),_(23,ke,5,2,"div",11),n(),o(24,"div",10)(25,"h3"),c(26,"Precio"),n(),o(27,"div",12)(28,"label")(29,"span"),c(30,"Min"),n(),o(31,"input",13),h("change",function(){return u(r),f(i.onPriceChange())}),n()(),o(32,"label")(33,"span"),c(34,"Max"),n(),o(35,"input",14),h("change",function(){return u(r),f(i.onPriceChange())}),n()()()()()(),o(36,"main",15),_(37,Fe,4,2,"section",16),o(38,"section",17)(39,"label"),c(40," Ordenar por: "),o(41,"select",18),h("change",function(){return u(r),f(i.applyFilters())}),o(42,"option",19),c(43,"Relevancia"),n(),o(44,"option",20),c(45,"Precio \u2191"),n(),o(46,"option",21),c(47,"Precio \u2193"),n(),o(48,"option",22),c(49,"Novedades"),n()()()(),_(50,Te,2,2,"section",23)(51,Ve,3,1,"ng-template",null,1,$)(53,ze,7,4,"nav",24),n()(),o(54,"button",25,2),h("click",function(){return u(r),f(i.toggleCartPanel())}),o(56,"span",26),c(57,"\u{1F6D2}"),n(),o(58,"span",27),c(59,"Carrito"),n(),_(60,Le,2,1,"span",28),P(61,"async"),n(),o(62,"div",29)(63,"div",30)(64,"h2",31),c(65,"Tu carrito"),n(),o(66,"button",32),h("click",function(){return u(r),f(i.closeCartPanel())}),c(67," \xD7 "),n()(),_(68,Re,4,3,"ng-container",33),P(69,"async"),n(),_(70,De,5,0,"ng-template",null,3,$)(72,Qe,1,0,"div",34)}if(e&2){let r=N(52);T("filters-open",i.isFiltersOpen),s(2),k("aria-expanded",i.isFiltersOpen),s(3),g("ngIf",i.isFiltersOpen),s(),T("open",i.isFiltersOpen),s(),g("formGroup",i.filtersForm),s(4),g("ngForOf",i.categoryOptions),s(4),g("ngForOf",i.subCategoryOptions),s(4),g("ngForOf",i.sizeOptions),s(4),g("ngForOf",i.colorOptions),s(14),g("ngIf",i.appliedChips==null?null:i.appliedChips.length),s(4),g("formControl",i.filtersForm.controls.sort),s(9),g("ngIf",i.filteredProducts==null?null:i.filteredProducts.length)("ngIfElse",r),s(3),g("ngIf",i.filteredProducts==null?null:i.filteredProducts.length),s(),k("aria-expanded",i.isCartPanelOpen),s(6),g("ngIf",V(61,23,i.cartCount$)),s(2),T("open",i.isCartPanelOpen),k("aria-hidden",!i.isCartPanelOpen),s(6),g("ngIf",V(69,25,i.cartItems$)),s(4),g("ngIf",i.isCartPanelOpen)}},dependencies:[Y,U,X,fe,ae,me,ge,ie,se,de,re,ne,ue,he,le,ce,pe,J,te,H,K],styles:["[_nghost-%COMP%]{display:block;padding:1.25rem 1rem 3rem;color:#111827;background:#f5f6fb;overflow-x:hidden}.catalog-wrapper[_ngcontent-%COMP%]{display:grid;gap:1.5rem;position:relative;align-items:start}.mobile-filters-bar[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.filters-toggle[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.4rem;padding:.65rem 1.1rem;background:#111827;color:#fff;border:none;border-radius:999px;cursor:pointer;font-weight:600;font-size:.9rem}.filters-backdrop[_ngcontent-%COMP%]{position:fixed;top:var(--navbar-offset);left:0;right:0;bottom:0;background:#0f172a6b;z-index:20}.filters-panel[_ngcontent-%COMP%]{background:#fff;border-radius:18px;padding:1.25rem;padding-bottom:calc(1.75rem + env(safe-area-inset-bottom,0px));max-height:calc(100vh - 2rem);overflow-y:auto;z-index:30}.filters-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.25rem}.filters-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .65rem;font-size:.95rem;font-weight:600;color:#0f172a}.filters-section[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:.35rem;font-size:.9rem;color:#374151}.filters-section[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.55rem;cursor:pointer}.filters-section[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:16px;height:16px;border-radius:4px;border:1px solid #d1d5db;accent-color:#111827}.price-inputs[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.75rem}.price-inputs[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.3rem;font-size:.85rem;color:#4b5563;flex:1 1 120px}.price-inputs[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:.5rem .7rem;border:1px solid #d1d5db;border-radius:10px;background:#f9fafb;font-size:.95rem}.catalog-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.25rem}.applied-filters[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;gap:.75rem;background:#fff;padding:.85rem 1rem;border-radius:14px}.chip[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.4rem;padding:.45rem .8rem;border-radius:999px;border:1px solid #d1d5db;background:#f8fafc;color:#1f2937;cursor:pointer}.clear-all[_ngcontent-%COMP%]{margin-left:auto;background:transparent;border:none;color:#ef4444;font-weight:600;cursor:pointer}.toolbar[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;background:#fff;padding:.75rem 1rem;border-radius:14px}.toolbar[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.45rem .75rem;border-radius:10px;border:1px solid #d1d5db;background:#fff}.products[_ngcontent-%COMP%]{display:grid;gap:.9rem;grid-template-columns:repeat(auto-fill,minmax(170px,1fr))}@media (min-width: 768px){.products[_ngcontent-%COMP%]{gap:1.1rem;grid-template-columns:repeat(auto-fill,minmax(190px,1fr))}}.product-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;background:#fff;border-radius:14px;overflow:hidden;border:1px solid #e5e7eb;min-height:100%}.product-media[_ngcontent-%COMP%]{position:relative;background:#eef2f7;aspect-ratio:3 / 4;overflow:hidden}.product-media[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;display:block}.product-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.45rem;padding:.85rem .9rem 1rem}.price[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;color:#0f172a}.product-name[_ngcontent-%COMP%]{font-size:.95rem;font-weight:500;color:#1f2937;line-height:1.3;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;min-height:2.4em}.product-tags[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.35rem;font-size:.75rem}.tag[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.2rem .55rem;border-radius:999px;background:#f3f4f6;color:#4b5563;font-weight:500}.tag-color[_ngcontent-%COMP%]{background:#fee2e2;color:#b91c1c}.product-actions[_ngcontent-%COMP%]{margin-top:.75rem}.add-to-cart[_ngcontent-%COMP%]{width:100%;padding:.6rem .9rem;border-radius:12px;border:none;background:#111827;color:#fff;font-weight:600;font-size:.95rem;cursor:pointer;transition:background .18s ease}.add-to-cart[_ngcontent-%COMP%]:hover, .add-to-cart[_ngcontent-%COMP%]:focus-visible{background:#0f172a}.add-to-cart[_ngcontent-%COMP%]:focus-visible{outline:2px solid rgba(59,130,246,.5);outline-offset:3px}.empty-state[_ngcontent-%COMP%]{background:#fff;border-radius:14px;padding:2.5rem 1rem;text-align:center;color:#6b7280}.pagination[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.75rem;margin-top:.5rem}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.55rem 1.1rem;border-radius:999px;border:none;background:#111827;color:#fff;cursor:pointer;font-weight:600}.pagination[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%]{opacity:.4;cursor:not-allowed;box-shadow:none;transform:none}@media (min-width: 1024px){.catalog-wrapper[_ngcontent-%COMP%]{grid-template-columns:260px 1fr}.mobile-filters-bar[_ngcontent-%COMP%], .filters-backdrop[_ngcontent-%COMP%]{display:none}.filters-panel[_ngcontent-%COMP%]{position:sticky;top:4.5rem;transform:none!important;max-height:calc(100vh - 5rem)}}@media (max-width: 1023px){.catalog-wrapper[_ngcontent-%COMP%]{grid-template-columns:1fr}.filters-panel[_ngcontent-%COMP%]{position:fixed;top:var(--navbar-offset);bottom:max(env(safe-area-inset-bottom,0px),0px);left:0;width:min(88vw,320px);border-radius:0;max-height:none;transform:translate(-105%)}.filters-panel.open[_ngcontent-%COMP%]{transform:translate(0)}}"],changeDetection:0})};export{R as default};
